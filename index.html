<!-- 
  Copyright 2010-2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.
 
  This file is licensed under the Apache License, Version 2.0 (the "License").
  You may not use this file except in compliance with the License. A copy of
  the License is located at
 
  http://aws.amazon.com/apache2.0/
 
  This file is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
  CONDITIONS OF ANY KIND, either express or implied. See the License for the
  specific language governing permissions and limitations under the License.

  Modify by Tung Nguyen @2021
-->
<html>

<head>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://sdk.amazonaws.com/js/aws-sdk-2.7.16.min.js"></script>
  <script src="./js/my.js"></script>
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark navbar-fixed-top" id="home">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03"
      aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand font-weight-bold text-warning" href="#">DynamoDB Demo</a>

    <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
      <ul class="navbar-nav mr-auto mt-2 mt-lg-0">

        <li class="nav-item active ">
          <a class="nav-link" data-toggle="collapse" href="#collapseOne">Config<span
              class="sr-only glyphicon glyphicon-chevron-right">(current)</span><i class="fas fa-user"></i></a>
        </li>
        <li class="nav-item active">
          <a class="nav-link glyphicon glyphicon-chevron-right" href="#collapseTwo" data-toggle="collapse">Create
            table<span class="sr-only glyphicon glyphicon-chevron-right">(current)</span></a>
        </li>

        <li class="nav-item active">
          <a class="nav-link" href="#collapseThree" data-toggle="collapse">Inport data<span
              class="sr-only glyphicon glyphicon-chevron-right">(current)</span></a>
        </li>

        <li class="nav-item active">
          <a class="nav-link" href="#collapseFour" data-toggle="collapse">View data<span
              class="sr-only glyphicon glyphicon-chevron-right">(current)</span></a>
        </li>

        <li class="nav-item active">
          <a class="nav-link " href="#collapseFive" data-toggle="collapse">About</a>
        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0" action="">
        <input class="form-control mr-sm-1" id="yearbox" type="number" placeholder="Year" aria-label="Search"
          value="2013" style="display: none;">
        <input class="form-control mr-sm-2" id="searchbox" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="button" onclick="queryData();">Search</button>
      </form>
    </div>
  </nav>

  <div class="container my-3">
    <p class="lead">Quick start: Use the menu in the following order</p>
  </div>
  <!-- -------------------- -->

  <div id="accordion" class="container">
    <div class="card">
      <div class="card-header" id="headingOne">
        <h4 class="mb-0">
          <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true"
            aria-controls="collapseOne">
            1. AWS Credentials
          </button>
        </h4>
      </div>

      <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
        <div class="card-body">
          <div class=" bg-light" id="collapseConfig">
            <div class="form-group">
              <label for="accessKeyId">AWS Region Code</label>
              <input type="text" class="form-control" id="regionCode" placeholder="Enter AWS Region code"
                value="us-east-1">
            </div>
            <div class="form-group">
              <label for="accessKeyId">Access Key Id</label>
              <input type="text" class="form-control" id="accessKeyId" aria-describedby="emailHelp"
                placeholder="Enter access key id">
              <small id="emailHelp" class="form-text text-muted">We'll never save or share your credentials with
                anyone.</small>
            </div>
            <div class="form-group">
              <label for="secretAccessKey">Secret Access Key </label>
              <input type="text" class="form-control" id="secretAccessKey" placeholder="Secret Access Key ">
            </div>
            <div class="form-group">
              <label for="sessionToken">Session Token </label>
              <input type="text" class="form-control" id="sessionToken" placeholder="Session Token">
            </div>

            <button type="button" class="btn btn-primary" onclick="configureAWS();" data-toggle="collapse"
              href="#collapseOne">Config AWS</button>
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingTwo">
        <h4 class="mb-0">
          <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false"
            aria-controls="collapseTwo">
            2. Create Table
          </button>
        </h4>
      </div>
      <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
        <div class="card-body">
          <div class="form-group my-3" id="createTable">
            <div>
              <p class="lead">In this step, you create a table named Movies in AWS DynamoDB. The primary key for the
                table is composed of the
                following
                attributes:</p>
              <ul class="list-group">
                <li class="list-group-item">year – The partition key. The AttributeType is N for number.</li>
                <li class="list-group-item">title – The sort key. The AttributeType is S for string.
                </li>
              </ul>
            </div>
            <input class="btn btn-primary my-2" id="createTableButton" type="button" value="Create Table"
              onclick="createMovies();" href="#collapseTwo" data-toggle="collapse" />
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-header" id="headingThree">
        <h4 class="mb-0">
          <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree"
            aria-expanded="false" aria-controls="collapseThree">
            3. Import Data
          </button>
        </h4>
      </div>
      <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
        <div class="card-body">
          <div class="form-group my-3" id="loadData">
            <p class="lead">This will load movie data stored in this<a href="./data/moviedata.json" target="_blank">
                JSON file</a>.
              For security reasons,
              please download the file to your local drive first...</p>
            <form class="my-3" action="">
              <a class="btn btn-primary" href="./data/moviedata.json" download>Download</a>
              <div class="form-group my-3">
                <label for="fileinput" class="lead">... then use the choose file button to upload the file.</label>
                <input type="file" class="form-control-file" id="fileinput" accept='application/json'
                  href="#collapseThree" data-toggle="collapse">
              </div>
            </form>

            <script>
              document.getElementById('fileinput').addEventListener('change', processFile, false);
              console.log("heelo");
              var searchbox = document.getElementById('searchbox');
              searchbox.addEventListener('keyup', function () {
                console.log("heelo");
                if (searchbox.value.length == 0) {
                  document.getElementById('yearbox').style.display = 'none';
                } else {
                  document.getElementById('yearbox').style.display = 'block';
                }
              }, false);
            </script>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header" id="headingFour">
        <h4 class="mb-0">
          <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFour"
            aria-expanded="false" aria-controls="collapseFour">
            4. View Data (Search)
          </button>
        </h4>
      </div>
      <div id="collapseFour" class="collapse " aria-labelledby="headingFour" data-parent="#accordion">
        <div class="card-body">
          <div class="container my-3 show" id="tableContainer">
            <p class="lead">Use the search box to query or scan data from the DynamoDB table.</p>
            <table class="table" id="table">
              <thead class="thead-dark">
                <tr>
                  <th scope="col">#</th>
                  <th scope="col">Title</th>
                  <th scope="col">Year</th>
                  <th scope="col">Rating</th>
                </tr>
              </thead>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-header" id="headingFive">
        <h4 class="mb-0">
          <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseFive"
            aria-expanded="false" aria-controls="collapseFive">
            5. About
          </button>
        </h4>
      </div>
      <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
        <div class="card-body">
          <p class="lead">This demonstration is based on the
            <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Introduction.html"
              target="_blank">
              documentations</a> and the movie
            <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/samples/moviedata.zip"
              download="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/samples/moviedata.zip">dataset</a>
            provided by AWS, implemented by Tung Nguyen-2021.
          </p>
        </div>
      </div>
    </div>

  </div>


  <!-- --------------- -->



  <div class="container my-3">
    <h3 for="textarea">Console Output:</h3>
    <textarea class="form-control" readonly id="textarea"
      style="min-height:50px; height: 250px; font-family:'Courier New', Courier, monospace;"></textarea>
  </div>

</body>

</html>